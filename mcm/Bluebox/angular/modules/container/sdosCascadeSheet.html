<html>
<head>
    <link href="/angular/css/cascade.css" rel="stylesheet" type="text/css"/>
</head>
<body>


<md-dialog aria-label="Key Cascade visualization" ng-cloak="" flex="90">
    <md-toolbar>
        <div class="md-toolbar-tools">
     <span>
      Key Cascade visualization
     </span>
            <span flex="">
     </span>
            <md-button class="md-icon-button" ng-click="cancel()">
                <md-icon md-font-set="material-icons">
                    close
                </md-icon>
            </md-button>
        </div>
    </md-toolbar>
    <md-dialog-content class="bb-margin">

        <div ng-if="!isRenderComplete">
            <h3>Collecting data... </h3>
            <md-progress-circular class="md-warn" md-mode="indeterminate"
                                  md-diameter="80"></md-progress-circular>
        </div>

        <div layout="row" layout-xs="column">
            <div flex id="cascadeRendering"></div>
            <div flex>
                <h3>Icon legend</h3>
                <p><img src="/angular/icons/d3/masterkey.svg">Master key, <img
                        src="/angular/icons/d3/masterkey_new.svg">New master key, <img
                        src="/angular/icons/d3/deletable_key.svg">Deletable key</p>
                <p><img src="/angular/icons/d3/key_closed.svg">Node key, <img src="/angular/icons/d3/pluskey.svg">New
                    node key, <img src="/angular/icons/d3/key_object.svg">Object key</p>
                <p><img src="/angular/icons/d3/selected_key.svg"><img src="/angular/icons/d3/selected_file.svg">Path to
                    requested object, <img src="/angular/icons/d3/key_object_delete.svg"><img
                            src="/angular/icons/d3/plusfile_delete.svg">Marked for deletion</p>
                <p><img src="/angular/icons/d3/plusfile.svg">Object / File, <img
                        src="/angular/icons/d3/pluskey_object.svg">↓↑ Scroll through large nodes</p>


                <h3>Animation controls</h3>
                <p>The animation shows the steps for cascaded re-keying</p>
                <p>
                    <md-button class="md-raised" ng-click="run_animation_step()">
                        <md-icon md-font-set="material-icons">
                            play_arrow
                        </md-icon>
                        Single step
                    </md-button>

                    <md-button class="md-raised" ng-click="run_animation_autorun()">
                        <md-icon md-font-set="material-icons">
                            playlist_play
                        </md-icon>
                        Autorun
                    </md-button>
                </p>


                <h3>Cascaded re-keying steps</h3>
                <ol>
                    <li ng-style="current_animation_step == 1 && {'color': 'darkred', 'font-weight': 'bold', 'font-size': '1.2em'}">
                        SDOS scans the delete log and finds all the paths to those objects
                    </li>
                    <li ng-style="current_animation_step == 2 && {'color': 'darkred', 'font-weight': 'bold', 'font-size': '1.2em'}">
                        The Key-Source deletes and replaces its deletable key
                    </li>
                    <li ng-style="current_animation_step == 3 && {'color': 'darkred', 'font-weight': 'bold', 'font-size': '1.2em'}">
                        SDOS generates a new master key and encrypts it with the new deletable key
                    </li>
                </ol>


            </div>

        </div>


        <md-card>
            <md-card-title>
                <b>sdos_cascade_stats</b>
            </md-card-title>

            <md-card-content>
                <p class="bbAllocBlocks">{{ sdos_cascade_stats }}</p>
            </md-card-content>
        </md-card>


        <md-card>
            <md-card-title>
                <b>sdos_used_partitions</b>
            </md-card-title>

            <md-card-content>
                <md-button class="md-raised" ng-hide="showPartitions" ng-click="showPartitions = true;">show</md-button>
                <p ng-if="sdos_used_partitions && showPartitions" class="bbAllocBlocks">{{ sdos_used_partitions }}</p>
            </md-card-content>
        </md-card>


        <md-card>
            <md-card-title>
                <b>sdos_partition_mapping</b>
            </md-card-title>

            <md-card-content>
                <md-button class="md-raised" ng-hide="showMapping" ng-click="showMapping = true;">show</md-button>
                <p ng-if="sdos_used_partitions && showMapping" class="bbAllocBlocks">{{ sdos_partition_mapping }}</p>
            </md-card-content>
        </md-card>


        <md-card>
            <md-card-title>
                <b>sdos_batch_delete_log</b>
            </md-card-title>

            <md-card-content>
                <md-button class="md-raised" ng-hide="showLog" ng-click="showLog = true;">show</md-button>
                <p ng-if="sdos_batch_delete_log && showLog" class="bbAllocBlocks">{{ sdos_batch_delete_log }}</p>
            </md-card-content>
        </md-card>


    </md-dialog-content>
</md-dialog>
</body>
</html>